
# 必填
dataset: /home/zjc/data/flicker
dataset_kodak: /home/zjc/data/kodak/
dataset_clic: /home/zjc/data/CLICval2017/

# 训练输出
out_dir: ./checkpoints/
name: TinyLIC_MoE

# 训练设置
epochs: 20
batch_size: 18
test_batch_size: 1
num_workers: 16
patch_size: 256
seed: 42
clip_max_norm: 1.0
save: true

# 模型: TIC, TIC_MoE, TinyLIC, TinyLIC_MoE, TCM, TCM_MoE
# 各模型默认 N/M:
#   TIC / TIC_MoE:       N=128, M=192
#   TinyLIC / TinyLIC_MoE: N=128, M=320
#   TCM / TCM_MoE:       N=64,  M=320, Z=192
model: TinyLIC_MoE
N: 128
M: 320
# Z: 192     # 超先验瓶颈通道数 (仅 TCM/TCM_MoE 使用)

# RD loss, mse系数
lmbda: 1e-2
distortion: mse

# 优化器
learning_rate: 0.0001
aux_learning_rate: 0.001

# scheduler
milestones: [5,10,15]
gamma: 0.1

# device
cuda: true
gpu_id: 0

checkpoint: "/home/zjc/MoECodec/TinyLIC/pretrained/mse/checkpoint_q1.pth.tar"
TEST: False

#moe
enc_moe: True
dec_moe: True
moe_config:
  num_experts: 4
  capacity: 1.0
  n_shared_experts: 0
  hid_ratio: 4